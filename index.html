<html>

    <head>
        <title>G.C. PWA App</title>
        <script src="jquery-3.5.1.min.js"></script>
        <style>
            body {
                font-family: Arial, "Helvetica Neue", Helvetica;
            }

            li {
                list-style-type: none;
                margin: 15px;
            }

            h4 {
                font-size: 32px;
            }

            a {
                font-size: 24px;
                text-decoration: none;
            }

            input {
                font-size: 28px;
            }

            button {
                font-size: 21px;
            }
        </style>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />

        <link rel="manifest" href="./manifest.json">
        <link rel="apple-touch-icon" sizes="180x180" href="images/apple-icon-180.png">
        <link rel="apple-touch-icon" sizes="167x167" href="images/apple-icon-167.png">
        <link rel="apple-touch-icon" sizes="152x152" href="images/apple-icon-152.png">
        <link rel="apple-touch-icon" sizes="120x120" href="images/apple-icon-120.png">

        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-startup-image" href="images/apple-splash-2048-2732.png"
            media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2732-2048.png"
            media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1668-2388.png"
            media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2388-1668.png"
            media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1668-2224.png"
            media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2224-1668.png"
            media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1536-2048.png"
            media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2048-1536.png"
            media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1242-2688.png"
            media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2688-1242.png"
            media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1125-2436.png"
            media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2436-1125.png"
            media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-828-1792.png"
            media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1792-828.png"
            media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1242-2208.png"
            media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-2208-1242.png"
            media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-750-1334.png"
            media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1334-750.png"
            media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-640-1136.png"
            media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
        <link rel="apple-touch-startup-image" href="images/apple-splash-1136-640.png"
            media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">

    </head>

    <body>
        <div style="margin-bottom:15px;">
            <input type="text" id="searchtext" placeholder="TITLE SEARCH" style="width:63%;"> <button
                onclick="StartSearch();" style="width:15%;">üîç</button> <button onclick="location.reload();"
                style="width:15%;">üåÄ</button></div>
        <div id="dlarea" style="border:thin solid black;margin-bottom:10px;"></div>
        <div id="output" style="border:thin solid black;margin-bottom:10px;"></div>
        <button onclick="GetMoreData();" style="width:98%;">‚òÑÔ∏è LOAD MORE</button>
        <script>
            var outputarea = document.getElementById("output");
            var dlarea = document.getElementById("dlarea");
            var page = 1;
            var type = "featured";

            $(document).ready(function () {
                outputarea.innerHTML = "<h4>FEATURED</h4>";
                fetchurl = 'https://getcomics-cor.herokuapp.com/';

                $.ajax({
                    url: fetchurl,
                    type: 'GET',
                    dataType: "json",
                    success: DisplayData
                });
            });

            $("#searchtext").on('keyup', function (e) {
                if (e.keyCode === 13) {
                    StartSearch();
                }
            });

            function StartSearch() {
                page = 1;
                type = "search";
                outputarea.innerHTML = "<h4>RESULTS</h4>";
                fetchurl = 'https://getcomics-cor.herokuapp.com/?search=' + encodeURIComponent(document.getElementById("searchtext").value) + "&page=" + page;

                $.ajax({
                    url: fetchurl,
                    type: 'GET',
                    dataType: "json",
                    success: DisplayData
                });
            }

            function GetMoreData() {
                page += 1;

                if (type == "search") {
                    fetchurl = 'https://getcomics-cor.herokuapp.com/?search=' + encodeURIComponent(document.getElementById("searchtext").value) + "&page=" + page;
                } else {
                    fetchurl = 'https://getcomics-cor.herokuapp.com/' + "?page=" + page;
                }

                $.ajax({
                    url: fetchurl,
                    type: 'GET',
                    dataType: "json",
                    success: DisplayData
                });
            }

            function getdl(fetchurl) {
                //console.log(fetchurl);
                $.ajax({
                    url: fetchurl,
                    type: 'GET',
                    dataType: "json",
                    success: ShowDLs
                });
            }

            function ShowDLs(data) {
                //console.log(data);
                dlarea.innerHTML = "<h4>DOWNLOAD LINKS</h4>";
                $.each(data, function (key, value) {
                    dlarea.innerHTML += "<li><a href=\"" + value + "\">" + key + "</a></li>";
                });
            }

            function DisplayData(data) {
                //console.log(data);
                $.each(data.channel.item, function (i, item) {
                    outputarea.innerHTML += "<li><a href=\"javascript:;\" onclick=\"getdl(\'https://getcomics-cor.herokuapp.com/?get=" + encodeURIComponent(item.link) + "\')\">" + item.title + "</a></li>";
                });
            }
        </script>
        <script>
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker.register("/pwabuilder-sw.js").then((reg) => {
                        console.log("Service worker registered.", reg);
                    });
                });
            }
        </script>
        <script type="module">
            import "https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate";

            const el = document.createElement("pwa-update");
            document.body.appendChild(el);
        </script>
    </body>

</html>